<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}XJZçš„ç½‘ç«™{% endblock %}</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸš€ XJZ çš„ä¸ªäººç½‘ç«™</h1>
            <p>ç”¨ Rust å’Œ Axum æ„å»ºçš„ç°ä»£åŒ–ç½‘ç«™</p>
        </header>

        <nav>
            <ul>
                <li><a href="/">ğŸ  ä¸»é¡µ</a></li>
                <li><a href="/projects">ğŸš€ æˆ‘çš„é¡¹ç›®</a></li>
                <li><a href="/blog">ğŸ“ æŠ€æœ¯åšå®¢</a></li>
                <li><a href="/resume">ğŸ“„ ç®€å†</a></li>
                <li><a href="/contact">ğŸ“§ è”ç³»æˆ‘</a></li>
                <li><a href="/about">ğŸ‘¤ å…³äºæˆ‘</a></li>
                <li class="nav-tools">
                    <button id="theme-toggle" class="theme-btn" title="åˆ‡æ¢ä¸»é¢˜">
                        <span class="theme-icon">ğŸŒ™</span>
                    </button>
                    <button id="search-toggle" class="search-btn" title="æœç´¢">
                        <span class="search-icon">ğŸ”</span>
                    </button>
                </li>
            </ul>
        </nav>

        <!-- æœç´¢æ¡† -->
        <div id="search-overlay" class="search-overlay hidden">
            <div class="search-container">
                <div class="search-header">
                    <input type="text" id="search-input" placeholder="æœç´¢é¡¹ç›®ã€æŠ€èƒ½æˆ–å†…å®¹..." autocomplete="off">
                    <button id="search-close" class="search-close-btn">âœ•</button>
                </div>
                <div id="search-results" class="search-results">
                    <div class="search-placeholder">
                        <p>ğŸ” è¾“å…¥å…³é”®è¯æœç´¢é¡¹ç›®ã€æŠ€èƒ½æˆ–å†…å®¹</p>
                    </div>
                </div>
            </div>
        </div>

        <main class="fade-in">
            {% block content %}{% endblock %}
        </main>

        <footer>
            <p>&copy; 2025 XJZ - ç”± Rust å’Œ Axum å¼ºåŠ›é©±åŠ¨ âš¡</p>
        </footer>
    </div>

    <script>
        // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        class ThemeManager {
            constructor() {
                this.themeToggle = document.getElementById('theme-toggle');
                this.themeIcon = document.querySelector('.theme-icon');
                this.currentTheme = localStorage.getItem('theme') || 'light';
                
                this.init();
            }
            
            init() {
                this.applyTheme(this.currentTheme);
                this.themeToggle.addEventListener('click', () => this.toggleTheme());
            }
            
            toggleTheme() {
                this.currentTheme = this.currentTheme === 'light' ? 'dark' : 'light';
                this.applyTheme(this.currentTheme);
                localStorage.setItem('theme', this.currentTheme);
            }
            
            applyTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                this.themeIcon.textContent = theme === 'light' ? 'ğŸŒ™' : 'â˜€ï¸';
            }
        }

        // æœç´¢åŠŸèƒ½
        class SearchManager {
            constructor() {
                this.searchToggle = document.getElementById('search-toggle');
                this.searchOverlay = document.getElementById('search-overlay');
                this.searchInput = document.getElementById('search-input');
                this.searchClose = document.getElementById('search-close');
                this.searchResults = document.getElementById('search-results');
                
                // æœç´¢æ•°æ®
                this.searchData = [
                    { type: 'project', title: 'VxWorks Script Utils', description: 'VxWorksé¡¹ç›®çš„Pythonè‡ªåŠ¨åŒ–å·¥å…·', tags: ['Python', 'VxWorks', 'è‡ªåŠ¨åŒ–'], url: '/projects' },
                    { type: 'project', title: 'VideoSubtitleScreenshotStitcher', description: 'è§†é¢‘å­—å¹•æˆªå›¾æ‹¼æ¥å·¥å…·', tags: ['Python', 'EasyOCR', 'å›¾åƒå¤„ç†'], url: '/projects' },
                    { type: 'project', title: 'E2000-memo', description: 'ç¡¬ä»¶è¿æ¥æŒ‡å¯¼æ–‡æ¡£', tags: ['ç¡¬ä»¶', 'æ–‡æ¡£', 'è°ƒè¯•'], url: '/projects' },
                    { type: 'project', title: 'Browndust2hat', description: 'æ¸¸æˆè‡ªåŠ¨åŒ–æ§åˆ¶é¡¹ç›®', tags: ['Python', 'Webæ¥å£', 'æ¸¸æˆæ§åˆ¶'], url: '/projects' },
                    { type: 'project', title: 'CHarbor', description: 'Angularå‰ç«¯é¡¹ç›®', tags: ['Angular', 'TypeScript', 'å‰ç«¯å¼€å‘'], url: '/projects' },
                    { type: 'project', title: 'çŸ©é˜µä¹˜æ³•è¿ç®—ä¼˜åŒ–', description: 'åŒ…æ‹¬naive,unroll,neonç‰ˆæœ¬çš„çŸ©é˜µä¹˜æ³•ä¼˜åŒ–', tags: ['C/C++', 'NEON', 'ç®—æ³•ä¼˜åŒ–'], url: '/projects' },
                    { type: 'skill', title: 'Rust', description: 'ç³»ç»Ÿç¼–ç¨‹è¯­è¨€', tags: ['ç¼–ç¨‹è¯­è¨€', 'ç³»ç»Ÿç¼–ç¨‹'], url: '/resume' },
                    { type: 'skill', title: 'Python', description: 'é€šç”¨ç¼–ç¨‹è¯­è¨€', tags: ['ç¼–ç¨‹è¯­è¨€', 'è‡ªåŠ¨åŒ–'], url: '/resume' },
                    { type: 'skill', title: 'Angular', description: 'å‰ç«¯æ¡†æ¶', tags: ['å‰ç«¯', 'TypeScript'], url: '/resume' },
                    { type: 'skill', title: 'NEON', description: 'ARMå‘é‡åŒ–æŠ€æœ¯', tags: ['ä¼˜åŒ–', 'å¹¶è¡Œè®¡ç®—'], url: '/resume' },
                    { type: 'page', title: 'å…³äºæˆ‘', description: 'ä¸ªäººä»‹ç»å’ŒæŠ€æœ¯èƒŒæ™¯', tags: ['ä¸ªäººä¿¡æ¯'], url: '/about' },
                    { type: 'page', title: 'è”ç³»æˆ‘', description: 'è”ç³»æ–¹å¼å’Œåˆä½œä¿¡æ¯', tags: ['è”ç³»æ–¹å¼', 'åˆä½œ'], url: '/contact' },
                    { type: 'page', title: 'ç®€å†', description: 'æ•™è‚²èƒŒæ™¯å’Œé¡¹ç›®ç»éªŒ', tags: ['ç®€å†', 'ç»éªŒ'], url: '/resume' }
                ];
                
                this.init();
            }
            
            init() {
                this.searchToggle.addEventListener('click', () => this.showSearch());
                this.searchClose.addEventListener('click', () => this.hideSearch());
                this.searchOverlay.addEventListener('click', (e) => {
                    if (e.target === this.searchOverlay) this.hideSearch();
                });
                this.searchInput.addEventListener('input', (e) => this.handleSearch(e.target.value));
                
                // ESCé”®å…³é—­æœç´¢
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') this.hideSearch();
                });
            }
            
            showSearch() {
                this.searchOverlay.classList.remove('hidden');
                this.searchInput.focus();
            }
            
            hideSearch() {
                this.searchOverlay.classList.add('hidden');
                this.searchInput.value = '';
                this.showPlaceholder();
            }
            
            handleSearch(query) {
                if (query.trim() === '') {
                    this.showPlaceholder();
                    return;
                }
                
                const results = this.searchData.filter(item => 
                    item.title.toLowerCase().includes(query.toLowerCase()) ||
                    item.description.toLowerCase().includes(query.toLowerCase()) ||
                    item.tags.some(tag => tag.toLowerCase().includes(query.toLowerCase()))
                );
                
                this.displayResults(results, query);
            }
            
            displayResults(results, query) {
                if (results.length === 0) {
                    this.searchResults.innerHTML = `
                        <div class="search-no-results">
                            <p>ğŸ˜” æ²¡æœ‰æ‰¾åˆ°ä¸ "${query}" ç›¸å…³çš„å†…å®¹</p>
                        </div>
                    `;
                    return;
                }
                
                const html = results.map(item => `
                    <div class="search-result-item" onclick="window.location.href='${item.url}'">
                        <div class="result-type">${this.getTypeIcon(item.type)}</div>
                        <div class="result-content">
                            <h4>${this.highlightText(item.title, query)}</h4>
                            <p>${this.highlightText(item.description, query)}</p>
                            <div class="result-tags">
                                ${item.tags.map(tag => `<span class="result-tag">${tag}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                `).join('');
                
                this.searchResults.innerHTML = html;
            }
            
            showPlaceholder() {
                this.searchResults.innerHTML = `
                    <div class="search-placeholder">
                        <p>ğŸ” è¾“å…¥å…³é”®è¯æœç´¢é¡¹ç›®ã€æŠ€èƒ½æˆ–å†…å®¹</p>
                    </div>
                `;
            }
            
            getTypeIcon(type) {
                const icons = {
                    'project': 'ğŸš€',
                    'skill': 'ğŸ› ï¸',
                    'page': 'ğŸ“„'
                };
                return icons[type] || 'ğŸ“„';
            }
            
            highlightText(text, query) {
                if (!query) return text;
                const regex = new RegExp(`(${query})`, 'gi');
                return text.replace(regex, '<mark>$1</mark>');
            }
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            new ThemeManager();
            new SearchManager();
        });
    </script>
</body>
</html>