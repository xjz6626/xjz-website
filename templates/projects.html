{% extends "base.html" %}

{% block title %}æˆ‘çš„é¡¹ç›®{% endblock %}

{% block content %}
    <h1>æˆ‘çš„é¡¹ç›® ğŸš€</h1>
    <p>è¿™é‡Œå±•ç¤ºäº†æˆ‘åœ¨ GitHub ä¸Šçš„ä¸€äº›å¼€æºé¡¹ç›®å’ŒæŠ€æœ¯æ¢ç´¢ã€‚æ¯ä¸ªé¡¹ç›®éƒ½ä½“ç°äº†æˆ‘åœ¨ä¸åŒæŠ€æœ¯é¢†åŸŸçš„å­¦ä¹ å’Œå®è·µã€‚</p>

    <!-- é¡¹ç›®æœç´¢å’Œè¿‡æ»¤åŒºåŸŸ -->
    <div class="project-controls">
        <div class="search-container">
            <input type="text" id="project-search" placeholder="ğŸ” æœç´¢é¡¹ç›®..." class="search-input">
        </div>
        <div class="filter-container">
            <select id="language-filter" class="filter-select">
                <option value="all">æ‰€æœ‰è¯­è¨€</option>
            </select>
            <select id="sort-filter" class="filter-select">
                <option value="updated">æœ€è¿‘æ›´æ–°</option>
                <option value="stars">æœ€å¤šæ˜Ÿæ ‡</option>
                <option value="name">é¡¹ç›®åç§°</option>
                <option value="created">åˆ›å»ºæ—¶é—´</option>
            </select>
            <button id="clear-filters" class="btn btn-small btn-secondary">æ¸…é™¤ç­›é€‰</button>
        </div>
    </div>

    <!-- GitHub ç”¨æˆ·ç»Ÿè®¡åŒºåŸŸ -->
    <div class="github-stats-section">
        <h2>ğŸ“Š GitHub æ´»åŠ¨ç»Ÿè®¡</h2>
        <div id="github-stats" class="stats-container">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ“¦</div>
                    <div class="stat-content">
                        <span class="stat-number" id="total-repos">-</span>
                        <span class="stat-label">å…¬å¼€ä»“åº“</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â­</div>
                    <div class="stat-content">
                        <span class="stat-number" id="total-stars">-</span>
                        <span class="stat-label">è·å¾—æ˜Ÿæ ‡</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ´</div>
                    <div class="stat-content">
                        <span class="stat-number" id="total-forks">-</span>
                        <span class="stat-label">è¢«Fork</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸ‘¥</div>
                    <div class="stat-content">
                        <span class="stat-number" id="total-followers">-</span>
                        <span class="stat-label">å…³æ³¨è€…</span>
                    </div>
                </div>
            </div>
            
            <!-- è¯­è¨€ç»Ÿè®¡ -->
            <div class="language-stats">
                <h3>ğŸ’» ä¸»è¦ä½¿ç”¨è¯­è¨€</h3>
                <div id="language-chart" class="language-chart">
                    <!-- JavaScriptå°†åœ¨è¿™é‡Œç”Ÿæˆè¯­è¨€ç»Ÿè®¡å›¾ -->
                </div>
            </div>
            
            <!-- GitHubè´¡çŒ®å›¾ -->
            <div class="contribution-graph">
                <h3>ğŸ”¥ GitHub è´¡çŒ®çƒ­åŠ›å›¾</h3>
                <div class="contribution-note">
                    <p>ğŸ“ˆ æŸ¥çœ‹æˆ‘çš„ <a href="https://github.com/xjz6626" target="_blank">GitHub ä¸»é¡µ</a> äº†è§£è¯¦ç»†è´¡çŒ®å†å²</p>
                </div>
            </div>
        </div>
    </div>

    <!-- GitHub é¡¹ç›®å®æ—¶åŠ è½½åŒºåŸŸ -->
    <div class="github-section">
        <h2>ğŸ”¥ GitHub é¡¹ç›®</h2>
        <div id="github-loading" class="loading-spinner">
            <div class="spinner"></div>
            <p>æ­£åœ¨ä» GitHub åŠ è½½æœ€æ–°é¡¹ç›®...</p>
        </div>
        <div id="github-projects" class="projects-grid" style="display: none;">
            <!-- JavaScript å°†åœ¨è¿™é‡ŒåŠ¨æ€æ’å…¥ GitHub é¡¹ç›® -->
        </div>
        <div id="github-error" class="error-message" style="display: none;">
            <p>âš ï¸ æ— æ³•åŠ è½½ GitHub é¡¹ç›®ï¼Œè¯·ç¨åé‡è¯•</p>
        </div>
    </div>

    <!-- é¡¹ç›®è¯´æ˜ -->
    <div class="static-section">
        <h2>ğŸ“š é¡¹ç›®è¯´æ˜</h2>
        <div class="card">
            <p>ä»¥ä¸‹å±•ç¤ºçš„æ˜¯ä»æˆ‘çš„GitHubä»“åº“å®æ—¶è·å–çš„é¡¹ç›®ä¿¡æ¯ã€‚è¿™äº›é¡¹ç›®æ¶µç›–äº†è‡ªåŠ¨åŒ–å·¥å…·ã€åµŒå…¥å¼å¼€å‘ã€å‰ç«¯åº”ç”¨ã€ç®—æ³•ä¼˜åŒ–ç­‰å¤šä¸ªæŠ€æœ¯é¢†åŸŸã€‚</p>
            <div class="tech-highlights">
                <span class="highlight-tag">ğŸ”§ è‡ªåŠ¨åŒ–</span>
                <span class="highlight-tag">ğŸ–¥ï¸ åµŒå…¥å¼</span>
                <span class="highlight-tag">ğŸ…°ï¸ å‰ç«¯</span>
                <span class="highlight-tag">âš¡ ä¼˜åŒ–</span>
                <span class="highlight-tag">ğŸ¦€ Rust</span>
                <span class="highlight-tag">ï¿½ Python</span>
            </div>
        </div>
    </div>

    <!-- é¡¹ç›®ç»Ÿè®¡ï¼ˆåŠ¨æ€æ›´æ–°ï¼‰ -->
    <div class="github-stats">
        <h2>ğŸ“Š é¡¹ç›®ç»Ÿè®¡</h2>
        <div class="stats-grid">
            <div class="stat-item">
                <div class="stat-number" id="dynamic-total-projects">-</div>
                <div class="stat-label">æ€»é¡¹ç›®æ•°</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="dynamic-total-stars">-</div>
                <div class="stat-label">è·å¾—æ˜Ÿæ ‡</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="dynamic-total-forks">-</div>
                <div class="stat-label">è¢«Fork</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="dynamic-followers">-</div>
                <div class="stat-label">å…³æ³¨è€…</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>ğŸŒŸ æŠ€æœ¯å…³æ³¨ç‚¹</h2>
        <p>æˆ‘çš„é¡¹ç›®æ¶µç›–äº†å¤šä¸ªæŠ€æœ¯é¢†åŸŸï¼Œä»åµŒå…¥å¼ç³»ç»Ÿå¼€å‘åˆ°å‰ç«¯åº”ç”¨ï¼Œä»ç®—æ³•ä¼˜åŒ–åˆ°æ¸¸æˆè‡ªåŠ¨åŒ–ã€‚æˆ‘ç‰¹åˆ«å…³æ³¨ï¼š</p>
        <div class="focus-areas">
            <div class="focus-item">
                <span class="focus-icon">ğŸ”§</span>
                <div>
                    <h4>è‡ªåŠ¨åŒ–å·¥å…·å¼€å‘</h4>
                    <p>å¼€å‘æé«˜å·¥ä½œæ•ˆç‡çš„è‡ªåŠ¨åŒ–è„šæœ¬å’Œæ¸¸æˆæ§åˆ¶å·¥å…·</p>
                </div>
            </div>
            <div class="focus-item">
                <span class="focus-icon">ğŸ–¥ï¸</span>
                <div>
                    <h4>åµŒå…¥å¼ç³»ç»Ÿ</h4>
                    <p>VxWorks å’Œå…¶ä»–åµŒå…¥å¼å¹³å°çš„å¼€å‘ç»éªŒ</p>
                </div>
            </div>
            <div class="focus-item">
                <span class="focus-icon">ï¿½</span>
                <div>
                    <h4>ç®—æ³•ä¼˜åŒ–</h4>
                    <p>çŸ©é˜µä¹˜æ³•ç­‰è®¡ç®—å¯†é›†å‹ç®—æ³•çš„æ€§èƒ½ä¼˜åŒ–</p>
                </div>
            </div>
            <div class="focus-item">
                <span class="focus-icon">ğŸ…°ï¸</span>
                <div>
                    <h4>å‰ç«¯å¼€å‘</h4>
                    <p>Angularã€TypeScriptç­‰ç°ä»£å‰ç«¯æŠ€æœ¯æ ˆ</p>
                </div>
            </div>
            <div class="focus-item">
                <span class="focus-icon">ï¿½ğŸ¤–</span>
                <div>
                    <h4>è®¡ç®—æœºè§†è§‰</h4>
                    <p>å›¾åƒå¤„ç†å’ŒOCRæŠ€æœ¯çš„å®é™…åº”ç”¨</p>
                </div>
            </div>
            <div class="focus-item">
                <span class="focus-icon">ğŸ¦€</span>
                <div>
                    <h4>ç°ä»£è¯­è¨€æ¢ç´¢</h4>
                    <p>å­¦ä¹  Rust ç­‰ç°ä»£ç³»ç»Ÿç¼–ç¨‹è¯­è¨€</p>
                </div>
            </div>
            <div class="focus-item">
                <span class="focus-icon">âš¡</span>
                <div>
                    <h4>æ€§èƒ½ä¼˜åŒ–</h4>
                    <p>NEONå‘é‡åŒ–å’Œåº•å±‚ä¼˜åŒ–æŠ€æœ¯</p>
                </div>
            </div>
            <div class="focus-item">
                <span class="focus-icon">ğŸ®</span>
                <div>
                    <h4>æ¸¸æˆæŠ€æœ¯</h4>
                    <p>æ¸¸æˆè‡ªåŠ¨åŒ–å’ŒWebç•Œé¢æ§åˆ¶æŠ€æœ¯</p>
                </div>
            </div>
        </div>
    </div>

    <!-- é¡¹ç›®è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="project-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-project-title"></h3>
                <button class="modal-close" onclick="closeProjectModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-project-content">
                    <!-- é¡¹ç›®è¯¦æƒ…å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // æœ¬åœ°APIé…ç½®
        const API_BASE = '/api';
        
        // GitHub é¡¹ç›®åŠ è½½ç®¡ç†å™¨
        class GitHubProjectLoader {
            constructor() {
                this.loadingElement = document.getElementById('github-loading');
                this.projectsElement = document.getElementById('github-projects');
                this.errorElement = document.getElementById('github-error');
                this.allProjects = []; // å­˜å‚¨æ‰€æœ‰é¡¹ç›®æ•°æ®
                this.filteredProjects = []; // å­˜å‚¨è¿‡æ»¤åçš„é¡¹ç›®
                
                // åˆå§‹åŒ–æœç´¢å’Œè¿‡æ»¤
                this.initializeControls();
            }

            initializeControls() {
                const searchInput = document.getElementById('project-search');
                const languageFilter = document.getElementById('language-filter');
                const sortFilter = document.getElementById('sort-filter');
                const clearButton = document.getElementById('clear-filters');

                // æœç´¢è¾“å…¥äº‹ä»¶
                searchInput.addEventListener('input', () => {
                    this.filterAndDisplayProjects();
                });

                // è¯­è¨€è¿‡æ»¤äº‹ä»¶
                languageFilter.addEventListener('change', () => {
                    this.filterAndDisplayProjects();
                });

                // æ’åºäº‹ä»¶
                sortFilter.addEventListener('change', () => {
                    this.filterAndDisplayProjects();
                });

                // æ¸…é™¤ç­›é€‰
                clearButton.addEventListener('click', () => {
                    searchInput.value = '';
                    languageFilter.value = 'all';
                    sortFilter.value = 'updated';
                    this.filterAndDisplayProjects();
                });
            }

            async loadProjects() {
                try {
                    this.showLoading();
                    
                    console.log('ä»æœ¬åœ°APIè·å–é¡¹ç›®æ•°æ®...');
                    
                    // è°ƒç”¨æœ¬åœ°APIè·å–é¡¹ç›®æ•°æ®
                    const projectsResponse = await fetch(`${API_BASE}/projects`);
                    if (!projectsResponse.ok) {
                        throw new Error(`APIé”™è¯¯: ${projectsResponse.status}`);
                    }
                    
                    const projectsResult = await projectsResponse.json();
                    if (!projectsResult.success) {
                        throw new Error(projectsResult.message || 'è·å–é¡¹ç›®æ•°æ®å¤±è´¥');
                    }
                    
                    // å­˜å‚¨é¡¹ç›®æ•°æ®
                    this.allProjects = projectsResult.data || [];
                    this.filteredProjects = [...this.allProjects];
                    
                    console.log(`æˆåŠŸåŠ è½½ ${this.allProjects.length} ä¸ªé¡¹ç›®`);
                    
                    // æ›´æ–°è¯­è¨€è¿‡æ»¤å™¨é€‰é¡¹
                    this.updateLanguageFilter();
                    
                    // åŠ è½½ç»Ÿè®¡ä¿¡æ¯
                    this.loadUserStats();
                    
                    // æ¸²æŸ“é¡¹ç›®
                    this.displayProjects();
                    
                    this.showProjects();
                } catch (error) {
                    console.error('åŠ è½½é¡¹ç›®å¤±è´¥:', error);
                    this.showError(`åŠ è½½å¤±è´¥: ${error.message}`);
                }
            }

            async loadUserStats() {
                try {
                    console.log('ä»æœ¬åœ°APIè·å–ç»Ÿè®¡æ•°æ®...');
                    
                    const statsResponse = await fetch(`${API_BASE}/stats`);
                    if (!statsResponse.ok) {
                        console.warn('ç»Ÿè®¡æ•°æ®è·å–å¤±è´¥ï¼Œè·³è¿‡');
                        return;
                    }
                    
                    const statsResult = await statsResponse.json();
                    if (statsResult.success && statsResult.data) {
                        this.displayUserStats(statsResult.data);
                    }
                } catch (error) {
                    console.warn('ç»Ÿè®¡æ•°æ®åŠ è½½å¤±è´¥:', error);
                }
            }

            displayUserStats(statsData) {
                // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
                const updateStat = (id, value) => {
                    const element = document.getElementById(id);
                    if (element) element.textContent = value || 0;
                };
                
                // æ›´æ–°GitHubæ´»åŠ¨ç»Ÿè®¡åŒºåŸŸï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                updateStat('total-repos', statsData.total_projects);
                updateStat('total-stars', statsData.total_stars);
                updateStat('total-forks', statsData.total_forks);
                updateStat('total-followers', statsData.followers);
                
                // æ›´æ–°æ–°çš„åŠ¨æ€ç»Ÿè®¡åŒºåŸŸ
                updateStat('dynamic-total-projects', statsData.total_projects);
                updateStat('dynamic-total-stars', statsData.total_stars);
                updateStat('dynamic-total-forks', statsData.total_forks);
                updateStat('dynamic-followers', statsData.followers);
            }



            // è­¦å‘Šä¿¡æ¯æ˜¾ç¤ºæ–¹æ³•
            showLoadingWarning() {
                const warningDiv = document.createElement('div');
                warningDiv.innerHTML = `
                    <p>âš ï¸ æ­£åœ¨ä»åç«¯APIè·å–æ•°æ®ï¼Œè¯·ç¨å€™...</p>
                `;
                warningDiv.style.cssText = `
                    background: #fff3cd; 
                    border: 1px solid #ffeaa7; 
                    border-radius: 8px; 
                    padding: 12px; 
                    margin: 16px 0; 
                    text-align: center;
                `;
                
                this.projectsElement.insertBefore(warningDiv, this.projectsElement.firstChild);
            }

            // ç›´æ¥æ˜¾ç¤ºé¡¹ç›®è¯¦æƒ…ï¼Œå› ä¸ºç»Ÿè®¡æ•°æ®æ¥è‡ªåç«¯API



            async showProjectDetails(repoName) {
                const repo = this.allProjects.find(r => r.name === repoName);
                if (!repo) return;

                document.getElementById('modal-project-title').textContent = repo.name;
                
                // ç›´æ¥æ¸²æŸ“åŸºæœ¬ä¿¡æ¯ï¼Œä¸å†è°ƒç”¨GitHub APIè·å–é¢å¤–ä¿¡æ¯
                this.renderBasicProjectDetails(repo);
                document.getElementById('project-modal').style.display = 'flex';
            }



            renderBasicProjectDetails(repo) {
                const createdDate = new Date(repo.created_at).toLocaleDateString('zh-CN');
                const updatedDate = new Date(repo.updated_at).toLocaleDateString('zh-CN');

                const modalContent = document.getElementById('modal-project-content');
                modalContent.innerHTML = `
                    <div class="project-detail-section">
                        <h4>ğŸ“Š é¡¹ç›®ç»Ÿè®¡</h4>
                        <div class="project-meta-detail">
                            <div class="meta-item">
                                <span class="meta-value">${repo.stargazers_count}</span>
                                <span class="meta-label">æ˜Ÿæ ‡</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-value">${repo.forks_count}</span>
                                <span class="meta-label">Fork</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-value">${repo.open_issues_count}</span>
                                <span class="meta-label">Issues</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-value">${(repo.size / 1024).toFixed(1)}MB</span>
                                <span class="meta-label">å¤§å°</span>
                            </div>
                        </div>
                    </div>

                    <div class="project-detail-section">
                        <h4>ğŸ“ é¡¹ç›®æè¿°</h4>
                        <p>${repo.description || 'æš‚æ— æè¿°'}</p>
                    </div>

                    ${repo.topics && repo.topics.length > 0 ? `
                    <div class="project-detail-section">
                        <h4>ğŸ·ï¸ æ ‡ç­¾</h4>
                        <div class="project-topics-detail">
                            ${repo.topics.map(topic => `<span class="skill-tag">${topic}</span>`).join('')}
                        </div>
                    </div>
                    ` : ''}

                    ${repo.language ? `
                    <div class="project-detail-section">
                        <h4>ğŸ’» ä¸»è¦è¯­è¨€</h4>
                        <span class="skill-tag">${repo.language}</span>
                    </div>
                    ` : ''}

                    <div class="project-detail-section">
                        <h4>ğŸ“… æ—¶é—´ä¿¡æ¯</h4>
                        <p><strong>åˆ›å»ºæ—¶é—´:</strong> ${createdDate}</p>
                        <p><strong>æœ€åæ›´æ–°:</strong> ${updatedDate}</p>
                        ${repo.license ? `<p><strong>è®¸å¯è¯:</strong> ${repo.license.name}</p>` : ''}
                    </div>

                    <div class="project-detail-section">
                        <div class="project-links">
                            <a href="${repo.html_url}" target="_blank" class="btn">
                                ğŸ“– åœ¨ GitHub ä¸ŠæŸ¥çœ‹
                            </a>
                            ${repo.homepage ? `<a href="${repo.homepage}" target="_blank" class="btn btn-secondary">ğŸš€ è®¿é—®é¡¹ç›®ä¸»é¡µ</a>` : ''}
                        </div>
                    </div>
                `;
            }

            // æ›´æ–°è¯­è¨€è¿‡æ»¤å™¨é€‰é¡¹
            updateLanguageFilter() {
                const languageFilter = document.getElementById('language-filter');
                const languages = [...new Set(this.allProjects.map(repo => repo.language).filter(Boolean))];
                
                // æ¸…é™¤ç°æœ‰é€‰é¡¹ï¼ˆé™¤äº†"æ‰€æœ‰è¯­è¨€"ï¼‰
                while (languageFilter.children.length > 1) {
                    languageFilter.removeChild(languageFilter.lastChild);
                }
                
                // æ·»åŠ è¯­è¨€é€‰é¡¹
                languages.sort().forEach(language => {
                    const option = document.createElement('option');
                    option.value = language;
                    option.textContent = language;
                    languageFilter.appendChild(option);
                });
            }

            filterAndDisplayProjects() {
                const searchTerm = document.getElementById('project-search').value.toLowerCase();
                const selectedLanguage = document.getElementById('language-filter').value;
                const sortBy = document.getElementById('sort-filter').value;

                // æœç´¢è¿‡æ»¤
                this.filteredProjects = this.allProjects.filter(repo => {
                    const matchesSearch = searchTerm === '' || 
                        repo.name.toLowerCase().includes(searchTerm) ||
                        (repo.description && repo.description.toLowerCase().includes(searchTerm)) ||
                        (repo.topics && repo.topics.some(topic => topic.toLowerCase().includes(searchTerm)));
                    
                    const matchesLanguage = selectedLanguage === 'all' || repo.language === selectedLanguage;
                    
                    return matchesSearch && matchesLanguage;
                });

                // æ’åº
                this.sortProjects(sortBy);
                
                // æ˜¾ç¤ºç»“æœ
                this.displayProjects();
            }

            sortProjects(sortBy) {
                this.filteredProjects.sort((a, b) => {
                    switch (sortBy) {
                        case 'stars':
                            return b.stargazers_count - a.stargazers_count;
                        case 'name':
                            return a.name.toLowerCase().localeCompare(b.name.toLowerCase());
                        case 'created':
                            return new Date(b.created_at) - new Date(a.created_at);
                        case 'updated':
                        default:
                            return new Date(b.updated_at) - new Date(a.updated_at);
                    }
                });
            }

            displayProjects() {
                if (this.filteredProjects.length === 0) {
                    this.showNoResults();
                    return;
                }

                // æ˜¾ç¤ºç»“æœæ•°é‡
                this.showResultsCount();
                
                // æ¸²æŸ“é¡¹ç›®
                this.renderProjects(this.filteredProjects);
            }

            showNoResults() {
                this.projectsElement.innerHTML = `
                    <div class="no-results">
                        <h3>ğŸ” æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„é¡¹ç›®</h3>
                        <p>å°è¯•è°ƒæ•´æœç´¢æ¡ä»¶æˆ–ç­›é€‰å™¨</p>
                        <button onclick="document.getElementById('clear-filters').click()" class="btn btn-small">
                            æ¸…é™¤ç­›é€‰æ¡ä»¶
                        </button>
                    </div>
                `;
            }

            showResultsCount() {
                const countElement = document.querySelector('.results-count');
                if (countElement) {
                    countElement.remove();
                }
                
                const count = document.createElement('div');
                count.className = 'results-count';
                count.textContent = `æ‰¾åˆ° ${this.filteredProjects.length} ä¸ªé¡¹ç›®`;
                this.projectsElement.parentNode.insertBefore(count, this.projectsElement);
            }

            renderProjects(repos) {
                this.projectsElement.innerHTML = repos.map(repo => this.createProjectCard(repo)).join('');
            }

            createProjectCard(repo) {
                const language = repo.language || 'Unknown';
                const description = repo.description || 'æš‚æ— æè¿°';
                const updatedDate = new Date(repo.updated_at).toLocaleDateString('zh-CN');
                const topics = repo.topics || [];
                
                return `
                    <div class="project-card github-project">
                        <div class="project-header">
                            <h3>
                                <span class="project-icon">${this.getLanguageIcon(language)}</span>
                                ${repo.name}
                            </h3>
                            <div class="project-meta">
                                <span class="language">${language}</span>
                                <span class="stars">${repo.stargazers_count}</span>
                                <span class="forks">${repo.forks_count}</span>
                            </div>
                        </div>
                        <p class="project-description">${description}</p>
                        ${topics && topics.length > 0 ? `
                        <div class="project-skills">
                            ${topics.slice(0, 5).map(topic => `<span class="skill-tag">${topic}</span>`).join('')}
                        </div>
                        ` : ''}
                        <div class="project-footer">
                            <span class="update-time">ğŸ“… ${updatedDate}</span>
                            ${repo.homepage ? `<span class="homepage-link">ğŸ”— <a href="${repo.homepage}" target="_blank">æ¼”ç¤º</a></span>` : ''}
                        </div>
                        <div class="project-links">
                            <a href="${repo.html_url}" target="_blank" class="btn btn-small btn-primary">
                                æŸ¥çœ‹ä»£ç 
                            </a>
                            <button onclick="showProjectDetails('${repo.name}')" class="btn btn-small btn-secondary">
                                è¯¦ç»†ä¿¡æ¯
                            </button>
                            ${repo.homepage ? `<a href="${repo.homepage}" target="_blank" class="btn btn-small btn-secondary">è®¿é—®é¡¹ç›®</a>` : ''}
                        </div>
                    </div>
                `;
            }

            getLanguageIcon(language) {
                const icons = {
                    'Python': 'ğŸ',
                    'JavaScript': 'ğŸŸ¨',
                    'TypeScript': 'ğŸ”·',
                    'Rust': 'ğŸ¦€',
                    'Go': 'ğŸ¹',
                    'Java': 'â˜•',
                    'C++': 'âš¡',
                    'C': 'ğŸ”§',
                    'HTML': 'ğŸŒ',
                    'CSS': 'ğŸ¨',
                    'Shell': 'ğŸš',
                    'Vue': 'ğŸ’š',
                    'React': 'âš›ï¸',
                    'Angular': 'ğŸ…°ï¸'
                };
                return icons[language] || 'ğŸ“„';
            }

            showLoading() {
                this.loadingElement.style.display = 'block';
                this.projectsElement.style.display = 'none';
                this.errorElement.style.display = 'none';
            }

            showProjects() {
                this.loadingElement.style.display = 'none';
                this.projectsElement.style.display = 'grid';
                this.errorElement.style.display = 'none';
            }

            showError() {
                this.loadingElement.style.display = 'none';
                this.projectsElement.style.display = 'none';
                this.errorElement.style.display = 'block';
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåå¯åŠ¨
        document.addEventListener('DOMContentLoaded', () => {
            const loader = new GitHubProjectLoader();
            loader.loadProjects();
            
            // å°†å®ä¾‹è®¾ç½®ä¸ºå…¨å±€å˜é‡ï¼Œä»¥ä¾¿æ¨¡æ€æ¡†ä½¿ç”¨
            window.githubLoader = loader;
        });

        // å…¨å±€æ¨¡æ€æ¡†æ§åˆ¶å‡½æ•°
        function showProjectDetails(repoName) {
            if (window.githubLoader) {
                window.githubLoader.showProjectDetails(repoName);
            }
        }

        function closeProjectModal() {
            document.getElementById('project-modal').style.display = 'none';
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('project-modal');
            if (e.target === modal) {
                closeProjectModal();
            }
        });

        // ESCé”®å…³é—­æ¨¡æ€æ¡†
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeProjectModal();
            }
        });
    </script>

    <style>
        /* æŠ€æœ¯æ ‡ç­¾é«˜äº®æ ·å¼ */
        .tech-highlights {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
            margin-top: 1rem;
            justify-content: center;
        }

        .highlight-tag {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 2px 4px rgba(99, 102, 241, 0.3);
            transition: transform 0.2s ease;
        }

        .highlight-tag:hover {
            transform: translateY(-2px);
        }
    </style>
{% endblock %}